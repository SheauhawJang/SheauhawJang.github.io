<!DOCTYPE html>
<html lang="en-US">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <meta name="description" content="Supports Mahjong Theory calculation for Normal Type Mahjong, Chinese Official Mahjong (MCR), Japanese Riichi Mahjong (RCR), 16-tile Mahjong, Hong Kong Style Taiwanese Mahjong, and any-tile-count Mahjong. Supports Joker (wild tile, universal tile, laizi, magic tile, etc.). Supports point or score calculation for Chinese Official Mahjong (MCR) and Japanese Riichi Mahjong (RCR).">
        <title>Mahjong Theory & Score Calculator</title>
        <link rel="stylesheet" href="mahjong.css" />
    </head>
    <body>
        <div class="language-bar">
            <div class="language-bar-group">
                <a onclick="updateCardSkin('jp')">Mahjong Soul Skin</a>
                <a onclick="updateCardSkin('gb')">Tziakcha Skin</a>
                <a onclick="updateCardSkin('qq')">Tencent Skin</a>
                <a onclick="updateCardSkin('hk')">Let's Mahjong Skin</a>
            </div>
            <div class="language-bar-group">
                <a href="mahjong.html">简体中文</a>
                <a href="mahjong-tw.html">正體中文</a>
                <a href="mahjong-ja.html">日本語</a>
                <a>English</a>
            </div>
        </div>
        <h1>Mahjong Theory & Score Calculator</h1>
        <ul class="input-note-wrapper" style="padding-left: 1.5em; margin-left: 0;">
            <li>Supports Mahjong Theory calculation for Normal Type Mahjong, Chinese Official Mahjong (MCR), Japanese Riichi Mahjong (RCR), 16-tile Mahjong, Hong Kong Style Taiwanese Mahjong, and any-tile-count Mahjong.</li>
            <li>Supports Joker (wild tile, universal tile, laizi, magic tile, etc.).</li>
            <li>Supports point or score calculation for Chinese Official Mahjong (MCR) and Japanese Riichi Mahjong (RCR).</li>
        </ul>
        <div class="section">
            <div class="title-button-container">
                <label for="inputText">Please enter your hand</label>
                <button class="toggle-button" id="inputButton" onclick="toggleInput()" style="color: #f58c8a">Open Input Panel ▼</button>
            </div>
            <div class="input-area" id="textInput">
                <input type="text" id="inputText" placeholder="For example：1112345678999mE" />
                <div class="input-note-wrapper">
                    <button class="toggle-button" id="inputNoteButton" onclick="toggleNote()" style="color: #4caf50">Show input instructions ▼</button>
                    <div class="input-note" id="inputNote" style="display: none">
                        The input field supports the following formats, which can be mixed:
                        <ol style="margin-top: 0">
                            <li>Tenhou Format: Suits are represented by number + color (lowercase), where: <b>Characters=m</b>, <b>Bamboo=s</b>, <b>Circles=p</b>. Honors, <b>East / South / West / North / White Dragon / Green Dragon / Red Dragon</b>, are represented by <b>1z2z3z4z5z6z7z</b> in order. Adjacent tiles with the same color suffix can only keep the suffix of the rightmost tile.</li>
                            <li>
                                Chinese Official Mahjong Helper Format: Suits are the same as "Tenhou Format". Honors,
                                <b>East / South / West / North / White Dragon / Green Dragon / Red Dragon</b>, are represented by <b>ESWNPFC</b> in order.
                            </li>
                            <li>English Mahjong Printing Format: Suits are the same as "Tenhou Format". Winds, <b>East / South / West / North</b>, are represented by <b>ESWN</b> in order. Dragons, <b>White=Wh</b>, <b>Green=G</b>, <b>Red=R</b>.</li>
                            <li>Hanyu Pinyin Format: Same as Tenhou Format. Except <b>Characters=w</b>,<b>Circles=b</b>.</li>
                            <li>Notation Format: Character tiles are represented by Chinese numbers <b>一二三四五六七八九</b>. Circle tiles are represented by circled numbers <b>①②③④⑤⑥⑦⑧⑨</b>. Bamboo tiles are represented by full-width numbers <b>１２３４５６７８９</b>. Honor tiles are represented by corresponding Chinese characters.</li>
                            <li>Unicode Format: Use Unicode U+1F000 to U+1F02B characters to represent the corresponding cards.</li>
                        </ol>
                        <p>About Bonus: <b>Spring / Summer / Autumn / Winter / Plum / Orchid / Chrysanthemum / Bamboo</b> are represented by <b>1h2h3h4h5h6h7h8h</b> or <b>1f2f3f4f5f6f7f8f</b> in order. Some mahjong rules consider bonus as joker. This calculator does not have this function. Please convert them into joker if necessary.<br /></p>
                        About Joker:
                        <ul style="margin-top: 0">
                            <li>
                                Non-directional Joker
                                <img src="./cards/a1j.gif" style="vertical-align: middle" />: Can be considered as any suit or honor tile. Represented by <b>1j/J</b>.
                            </li>
                            <li>Characters Joker <img src="./cards/a2j.gif" style="vertical-align: middle" />: Can be considered as any character tile. Represented by <b>2j/im/iw</b>.</li>
                            <li>Circles Joker <img src="./cards/a3j.gif" style="vertical-align: middle" />: Can be considered as any circle tile. Represented by <b>3j/ip/ib</b>.</li>
                            <li>Bamboo Joker <img src="./cards/a4j.gif" style="vertical-align: middle" />: Can be considered as any bamboo tile. Represented by <b>4j/is</b>.</li>
                            <li>Suits Joker <img src="./cards/a5j.gif" style="vertical-align: middle" />: Can be considered as any suit tile. Represented by <b>5j</b>.</li>
                            <li>Winds Joker <img src="./cards/a6j.gif" style="vertical-align: middle" />: Can be considered as any wind tile. Represented by <b>6j</b>.</li>
                            <li>Dragons Joker <img src="./cards/a7j.gif" style="vertical-align: middle" />: Can be considered as any dragon tile. Represented by <b>7j</b>.</li>
                            <li>Honors Joker <img src="./cards/a8j.gif" style="vertical-align: middle" />: Can be considered as any honor tile. Represented by <b>8j/iz</b>.</li>
                            <li>Bonus Joker <img src="./cards/a9j.gif" style="vertical-align: middle" />: Can be considered as any bonus tile. Represented by <b>9j/H/X/9h/9f/ih/if</b>.</li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="input-area" id="boardInput" style="display: none">
                <div class="card-container" id="input-pic"></div>
                <div class="input-keyboard">
                    <div class="input-mainkey">
                        <div class="input-row">
                            <div></div>
                            <div class="card-div input-card-button"><img src="./cards/1m.gif" onclick="addInput(0)" /></div>
                            <div class="card-div input-card-button"><img src="./cards/2m.gif" onclick="addInput(1)" /></div>
                            <div class="card-div input-card-button"><img src="./cards/3m.gif" onclick="addInput(2)" /></div>
                            <div class="card-div input-card-button"><img src="./cards/4m.gif" onclick="addInput(3)" /></div>
                            <div class="card-div input-card-button"><img src="./cards/5m.gif" onclick="addInput(4)" /></div>
                            <div class="card-div input-card-button"><img src="./cards/6m.gif" onclick="addInput(5)" /></div>
                            <div class="card-div input-card-button"><img src="./cards/7m.gif" onclick="addInput(6)" /></div>
                            <div class="card-div input-card-button"><img src="./cards/8m.gif" onclick="addInput(7)" /></div>
                            <div class="card-div input-card-button"><img src="./cards/9m.gif" onclick="addInput(8)" /></div>
                            <div class="card-div input-card-button"><img src="./cards/0m.gif" onclick="addInput({ id: 4, sp: 1 })" /></div>
                            <div></div>
                        </div>
                        <div class="input-row">
                            <div></div>
                            <div class="card-div input-card-button"><img src="./cards/1p.gif" onclick="addInput(9)" /></div>
                            <div class="card-div input-card-button"><img src="./cards/2p.gif" onclick="addInput(10)" /></div>
                            <div class="card-div input-card-button"><img src="./cards/3p.gif" onclick="addInput(11)" /></div>
                            <div class="card-div input-card-button"><img src="./cards/4p.gif" onclick="addInput(12)" /></div>
                            <div class="card-div input-card-button"><img src="./cards/5p.gif" onclick="addInput(13)" /></div>
                            <div class="card-div input-card-button"><img src="./cards/6p.gif" onclick="addInput(14)" /></div>
                            <div class="card-div input-card-button"><img src="./cards/7p.gif" onclick="addInput(15)" /></div>
                            <div class="card-div input-card-button"><img src="./cards/8p.gif" onclick="addInput(16)" /></div>
                            <div class="card-div input-card-button"><img src="./cards/9p.gif" onclick="addInput(17)" /></div>
                            <div class="card-div input-card-button"><img src="./cards/0p.gif" onclick="addInput({ id: 13, sp: 1 })" /></div>
                            <div></div>
                        </div>
                        <div class="input-row">
                            <div></div>
                            <div class="card-div input-card-button"><img src="./cards/1s.gif" onclick="addInput(18)" /></div>
                            <div class="card-div input-card-button"><img src="./cards/2s.gif" onclick="addInput(19)" /></div>
                            <div class="card-div input-card-button"><img src="./cards/3s.gif" onclick="addInput(20)" /></div>
                            <div class="card-div input-card-button"><img src="./cards/4s.gif" onclick="addInput(21)" /></div>
                            <div class="card-div input-card-button"><img src="./cards/5s.gif" onclick="addInput(22)" /></div>
                            <div class="card-div input-card-button"><img src="./cards/6s.gif" onclick="addInput(23)" /></div>
                            <div class="card-div input-card-button"><img src="./cards/7s.gif" onclick="addInput(24)" /></div>
                            <div class="card-div input-card-button"><img src="./cards/8s.gif" onclick="addInput(25)" /></div>
                            <div class="card-div input-card-button"><img src="./cards/9s.gif" onclick="addInput(26)" /></div>
                            <div class="card-div input-card-button"><img src="./cards/0s.gif" onclick="addInput({ id: 22, sp: 1 })" /></div>
                            <div></div>
                        </div>
                        <div class="input-row">
                            <div></div>
                            <div class="card-div input-card-button"><img src="./cards/1z.gif" onclick="addInput(27)" /></div>
                            <div class="card-div input-card-button"><img src="./cards/2z.gif" onclick="addInput(28)" /></div>
                            <div class="card-div input-card-button"><img src="./cards/3z.gif" onclick="addInput(29)" /></div>
                            <div class="card-div input-card-button"><img src="./cards/4z.gif" onclick="addInput(30)" /></div>
                            <div class="card-div input-card-button"><img src="./cards/5z.gif" onclick="addInput(31)" /></div>
                            <div class="card-div input-card-button"><img src="./cards/6z.gif" onclick="addInput(32)" /></div>
                            <div class="card-div input-card-button"><img src="./cards/7z.gif" onclick="addInput(33)" /></div>
                            <div class="card-div input-card-button"><img src="./cards/0z.gif" onclick="addInput({ id: 31, sp: 1 })" /></div>
                            <div></div>
                        </div>
                        <div class="input-row">
                            <div></div>
                            <div class="card-div input-card-button"><img src="./cards/1h.gif" onclick="addInput(34)" /></div>
                            <div class="card-div input-card-button"><img src="./cards/2h.gif" onclick="addInput(35)" /></div>
                            <div class="card-div input-card-button"><img src="./cards/3h.gif" onclick="addInput(36)" /></div>
                            <div class="card-div input-card-button"><img src="./cards/4h.gif" onclick="addInput(37)" /></div>
                            <div class="card-div input-card-button"><img src="./cards/5h.gif" onclick="addInput(38)" /></div>
                            <div class="card-div input-card-button"><img src="./cards/6h.gif" onclick="addInput(39)" /></div>
                            <div class="card-div input-card-button"><img src="./cards/7h.gif" onclick="addInput(40)" /></div>
                            <div class="card-div input-card-button"><img src="./cards/8h.gif" onclick="addInput(41)" /></div>
                            <div></div>
                        </div>
                        <div class="input-row">
                            <div></div>
                            <div class="card-div input-card-button"><img src="./cards/1j.gif" onclick="addInput(42)" /></div>
                            <div class="card-div input-card-button"><img src="./cards/2j.gif" onclick="addInput(43)" /></div>
                            <div class="card-div input-card-button"><img src="./cards/3j.gif" onclick="addInput(44)" /></div>
                            <div class="card-div input-card-button"><img src="./cards/4j.gif" onclick="addInput(45)" /></div>
                            <div class="card-div input-card-button"><img src="./cards/5j.gif" onclick="addInput(46)" /></div>
                            <div class="card-div input-card-button"><img src="./cards/6j.gif" onclick="addInput(47)" /></div>
                            <div class="card-div input-card-button"><img src="./cards/7j.gif" onclick="addInput(48)" /></div>
                            <div class="card-div input-card-button"><img src="./cards/8j.gif" onclick="addInput(49)" /></div>
                            <div class="card-div input-card-button"><img src="./cards/9j.gif" onclick="addInput(50)" /></div>
                            <div></div>
                        </div>
                        <div class="card-container" id="input-pic-bonus"></div>
                        <div class="output-options">
                            <span>Dora Indicator</span>
                            <div class="card-container" id="input-pic-dorap"></div>
                            <span>Ura Dora Indicator</span>
                            <div class="card-container" id="input-pic-urap"></div>
                        </div>
                    </div>
                    <div class="input-subkeys">
                        <button onclick="clearInput()" class="subkey-button">Clear</button>
                        <button onclick="sortInput()" class="subkey-button">Sort</button>
                        <button onclick="removeInput(ipids[0].length - 1, -1)" class="subkey-button enable-no-empty">Delete</button>
                        <button onclick="subtileInput(0)" class="subkey-button" id="subkey_chi">Chow</button>
                        <button onclick="subtileInput(1)" class="subkey-button enabled-no-flower">Pung</button>
                        <button onclick="subtileInput(2, 1)" class="subkey-button enabled-no-flower">Expose Kong</button>
                        <button onclick="subtileInput(2, 5)" class="subkey-button enabled-no-flower">Extend Kong</button>
                        <button onclick="subtileInput(2, 0)" class="subkey-button enabled-no-flower">Conceal Kong</button>
                        <button onclick="subtileInput(3)" class="subkey-button enable-no-empty">+Bonus</button>
                        <button onclick="subtileInput(4)" class="subkey-button enable-no-empty">Dora Indicate</button>
                        <button onclick="subtileInput(5)" class="subkey-button enable-no-empty">Ura Dora Indicate</button>
                    </div>
                </div>
            </div>
            <div style="text-align: center">
                <button onclick="processInput()" class="random-button">Calculate</button>
                <button onclick="randomInput()" class="random-button">Get <input type="number" id="randomCardCount" value="14" min="1" max="99" /> random tiles</button>
            </div>
            <div class="output-box-head">
                <div class="output-context" style="text-align: center" id="output-cnt"></div>
                <div class="card-container" id="output-pic"></div>
                <div class="card-container" id="output-pic-bonus" style="text-align: right"></div>
            </div>
            <div class="output-box">
                <div class="title-button-container">
                    <div class="output-title">Normal Type Theory</div>
                    <button class="toggle-button" id="toggle-output-std" onclick="toggleOutput(0)">Fold ▲</button>
                </div>
                <div class="output-context" id="output-std"></div>
                <div class="output-context" id="brief-output-std" style="display: none"></div>
                <div class="output-time" id="time-output-std"></div>
            </div>
            <div class="output-box">
                <div class="title-button-container">
                    <div class="output-title">Chinese Official Mahjong (MCR) Standard Type Theory</div>
                    <button class="toggle-button" id="toggle-output-gb" onclick="toggleOutput(1)">Fold ▲</button>
                </div>
                <div class="output-context" id="output-gb"></div>
                <div class="output-context" id="brief-output-gb" style="display: none"></div>
                <div class="output-time" id="time-output-gb"></div>
            </div>
            <div class="output-box">
                <div class="title-button-container">
                    <div class="output-title">Japanese Riichi Mahjong (RCR) Standard Type Theory</div>
                    <button class="toggle-button" id="toggle-output-jp" onclick="toggleOutput(2)">Fold ▲</button>
                </div>
                <div class="output-context" id="output-jp"></div>
                <div class="output-context" id="brief-output-jp" style="display: none"></div>
                <div class="output-time" id="time-output-jp"></div>
            </div>
            <div class="output-box">
                <div class="title-button-container">
                    <div class="output-title">Hong Kong Style Taiwanese Mahjong Theory</div>
                    <button class="toggle-button" id="toggle-output-tw" onclick="toggleOutput(3)">Fold ▲</button>
                </div>
                <div class="output-context" id="output-tw"></div>
                <div class="output-context" id="brief-output-tw" style="display: none"></div>
                <div class="output-time" id="time-output-tw"></div>
            </div>
            <div class="output-box" id="score-gb">
                <div class="title-button-container">
                    <div class="output-title">Chinese Official Mahjong (MCR) Points Calculator</div>
                    <button class="toggle-button" id="toggle-output-score-gb" onclick="toggleOutput(4)">Fold ▲</button>
                </div>
                <div id="options-output-score-gb">
                    <div class="output-options">
                        <span>Prevalent</span>
                        <div class="output-option-group">
                            <label><input type="radio" name="score-gb-global-wind" value="27" checked />East</label>
                            <label><input type="radio" name="score-gb-global-wind" value="28" />South</label>
                            <label><input type="radio" name="score-gb-global-wind" value="29" />West</label>
                            <label><input type="radio" name="score-gb-global-wind" value="30" />North</label>
                        </div>
                        <span>Seat</span>
                        <div class="output-option-group">
                            <label><input type="radio" name="score-gb-local-wind" value="27" checked />East</label>
                            <label><input type="radio" name="score-gb-local-wind" value="28" />South</label>
                            <label><input type="radio" name="score-gb-local-wind" value="29" />West</label>
                            <label><input type="radio" name="score-gb-local-wind" value="30" />North</label>
                        </div>
                        <span>Winning Way</span>
                        <div class="output-option-group">
                            <label><input type="radio" name="score-gb-wintype" value="0" checked />Claim</label>
                            <label><input type="radio" name="score-gb-wintype" value="80" />Draw</label>
                        </div>
                        <span>Winning Status</span>
                        <div class="output-option-group">
                            <label><input type="checkbox" name="score-gb-wininfo" value="44" />Last Tile</label>
                            <label><input type="checkbox" name="score-gb-wininfo" value="46" />Out with Replacement</label>
                            <label><input type="checkbox" name="score-gb-wininfo" value="47" />Robbing the Kong</label>
                            <label><input type="checkbox" name="score-gb-wininfo" value="58" />Last of its Kind</label>
                        </div>
                        <button onclick="processGBScore()" class="score-button">Calculate</button>
                    </div>
                    <details>
                        <summary>Rules Settings</summary>
                        <div class="output-options">
                            <span title="國標原文的不求人定義限定一般型。問答規則、MIL規則、JMSA規則不允許不求人複合下述所有台種。世麻規則允許不求人複合下述所有台種。疑難解析建議允許不求人複合下述所有台種。"><span class="fan">Fully Conc. Hand</span> with</span>
                            <div class="output-option-group">
                                <label><input type="checkbox" name="score-gb-setting" value="19" /><span class="fan">Nine Gates</span> / <span class="fan">Four Concealed Pungs</span></label>
                                <label><input type="checkbox" name="score-gb-setting" value="41" /><span class="fan">Seven (Shifted) Pairs</span></label>
                                <label><input type="checkbox" name="score-gb-setting" value="42" /><span class="fan">Thirteen Orphans</span></label>
                                <label><input type="checkbox" name="score-gb-setting" value="43" /><span class="fan">Honors and Knitted Tiles</span></label>
                            </div>
                            <span title="國標原文的下述台種定義限定一般型，但包含了七對複合字一色、清么九的牌例。疑難解析允許七對複合清一色、混一色、五門齊。問答規則建議允許，MIL規則允許七對複合清一色至混么九。世麻規則允許七對複合清一色至五門齊。JMSA規則允許七對複合清一色至推不倒、字一色至混么九。"><span class="fan">Seven Pairs</span> with</span>
                            <div class="output-option-group">
                                <label><input type="checkbox" name="score-gb-setting" value="5" checked /><span class="fan">Full Flush</span></label>
                                <label><input type="checkbox" name="score-gb-setting" value="10" checked /><span class="fan">Half Flush</span></label>
                                <label><input type="checkbox" name="score-gb-setting" value="1" checked /><span class="fan">All Green</span></label>
                                <label><input type="checkbox" name="score-gb-setting" value="6" checked /><span class="fan">Upper/Middle/Lower Tiles</span></label>
                                <label><input type="checkbox" name="score-gb-setting" value="7" checked /><span class="fan">Upper/Lower Four</span></label>
                                <label><input type="checkbox" name="score-gb-setting" value="9" checked /><span class="fan">Reversible Tiles</span></label>
                                <label><input type="checkbox" name="score-gb-setting" value="11" checked /><span class="fan">All Types</span></label>
                                <label><input type="checkbox" name="score-gb-setting" value="3" checked /><span class="fan">All Honors</span></label>
                                <label><input type="checkbox" name="score-gb-setting" value="2" checked /><span class="fan">All Terminals</span></label>
                                <label><input type="checkbox" name="score-gb-setting" value="4" checked /><span class="fan">All Terminals and Honors</span></label>
                                <label><input type="checkbox" name="score-gb-setting" value="40" checked /><span class="fan">Outside Hand</span></label>
                                <label title="由於張數限制，不可能出現。"><input type="checkbox" name="score-gb-setting" value="8" checked /><span class="fan">All Fives</span></label>
                                <label title="現行規則均不允許。"><input type="checkbox" name="score-gb-setting" value="12" /><span class="fan">All Even Pungs</span></label>
                            </div>
                            <span><span class="fan">Two Conc. Kongs</span></span>
                            <div class="output-option-group">
                                <label title="國標原文、問答規則、MIL規則、JMSA規則採用。"><input type="radio" name="score-gb-setting-1" value="0" checked />6 Points</label>
                                <label title="世麻規則採用。"><input type="radio" name="score-gb-setting-1" value="23" />8 Points</label>
                            </div>
                            <span><span class="fan">Conc. and Melded Kong</span></span>
                            <div class="output-option-group">
                                <label title="MIL規則、JMSA規則採用。"><input type="radio" name="score-gb-setting-2" value="0" checked />5 Points</label>
                                <label title="世麻規則採用。"><input type="radio" name="score-gb-setting-2" value="24,1" />6 Points</label>
                                <label title="1999年全國麻將運動比賽補充規定（參見疑難解析）。"><input type="radio" name="score-gb-setting-2" value="24,2" /><span class="fan">Melded Kong</span> + <span class="fan">Concealed Kong</span></label>
                                <label title="問答規則採用。"><input type="radio" name="score-gb-setting-2" value="24,3" /><span class="fan">Two Melded Kongs</span> + <span class="fan">Concealed Kong</span></label>
                            </div>
                            <span><span class="fan">Three/Four Kongs</span></span>
                            <div class="output-option-group">
                                <label title="MIL規則、JMSA規則採用。"><input type="radio" name="score-gb-setting-6" value="0" checked />Combine with <span class="fan">Concealed Pungs</span>, without <span class="fan">Concealed Kongs</span></label>
                                <label title="世麻規則採用。"><input type="radio" name="score-gb-setting-6" value="30,1" />Combine with <span class="fan">Concealed Pungs</span> and <span class="fan">Concealed Kongs</span></label>
                                <label title="問答規則採用。"><input type="radio" name="score-gb-setting-6" value="30,2" />A Certain Combination</label>
                            </div>
                            <span><span class="fan">Out with Repl. Tile</span></span>
                            <div class="output-option-group">
                                <label><input type="checkbox" name="score-gb-setting" value="31,1" />Combine without <span class="fan">Meld Kong</span></label>
                                <label title="疑難解析採用。"><input type="checkbox" name="score-gb-setting" value="31,2" />1 point deducted in <span class="fan">Melded/Concealed Kong</span></label>
                                <label title="問答規則、MIL規則、JMSA規則採用。"><input type="checkbox" name="score-gb-setting" value="32" checked />Combine with <span class="fan">Last Tile Draw</span></label>
                            </div>
                            <span>Omit <span class="fan">Pung of Term./Hon.</span></span>
                            <div class="output-option-group">
                                <label title="疑難解析採用。"><input type="checkbox" name="score-gb-setting" value="33" />1 point deducted in <span class="fan">Prevalent Wind</span> / <span class="fan">Seat Wind</span> / <span class="fan">Dragon Pung</span></label>
                                <label><input type="checkbox" name="score-gb-setting" value="34" /><span class="fan">Big Three Winds</span> does not omit</label>
                                <label><input type="checkbox" name="score-gb-setting" value="35" /><span class="fan">Little Four Winds</span> does not omit</label>
                            </div>
                            <span><span class="fan">Nine Gates</span></span>
                            <div class="output-option-group">
                                <label title="MIL規則採用。"><input type="radio" name="score-gb-setting-5" value="0" checked />Omit one <span class="fan">Pung of Terminals and Honors</span></label>
                                <label><input type="radio" name="score-gb-setting-5" value="27" />Omit all <span class="fan">Pung of Terminals and Honors</span></label>
                            </div>
                            <span title="國標原文、問答規則、世麻規則、MIL規則允許缺一門複合大三元至一色四節高。"><span class="fan">One Voided Suit</span> with</span>
                            <div class="output-option-group">
                                <label><input type="checkbox" name="score-gb-setting" value="13" checked /><span class="fan">Big Three Dragons</span></label>
                                <label><input type="checkbox" name="score-gb-setting" value="14" checked /><span class="fan">Little Three Dragons</span></label>
                                <label><input type="checkbox" name="score-gb-setting" value="15" checked /><span class="fan">Big Three Winds</span></label>
                                <label><input type="checkbox" name="score-gb-setting" value="16" checked /><span class="fan">Quadruple Chow</span></label>
                                <label><input type="checkbox" name="score-gb-setting" value="44" checked /><span class="fan">Four Shifted Chows</span></label>
                                <label><input type="checkbox" name="score-gb-setting" value="17" checked /><span class="fan">Four Pure Shifted Pungs</span></label>
                                <label><input type="checkbox" name="score-gb-setting" value="18" /><span class="fan">Reversible Tiles</span></label>
                            </div>
                            <span title="國標原文、問答規則、MIL規則允許混一色複合大四喜、小四喜；不允許混一色複合綠一色。世麻規則允許混一色複合下述所有台種。"><span class="fan">Half Flush</span> with</span>
                            <div class="output-option-group">
                                <label><input type="checkbox" name="score-gb-setting" value="20" checked /><span class="fan">Big Four Winds</span></label>
                                <label><input type="checkbox" name="score-gb-setting" value="21" checked /><span class="fan">Little Four Winds</span></label>
                                <label><input type="checkbox" name="score-gb-setting" value="22" /><span class="fan">All Green</span></label>
                            </div>
                            <span><span class="fan">All Terminals</span> with</span>
                            <div class="output-option-group">
                                <label title="世麻規則採用。問答規則、MIL規則不採用。"><input type="checkbox" name="score-gb-setting" value="28" /><span class="fan">Double Pung</span></label>
                                <label title="國標原文為“不計同刻”，若非筆誤則不採用。"><input type="checkbox" name="score-gb-setting" value="29" checked /><span class="fan">Triple Pung</span></label>
                            </div>
                            <span><span class="fan">Knitted Str.</span></span>
                            <div class="output-option-group">
                                <label><input type="radio" name="score-gb-setting-3" value="25" />Omit <span class="fan">Edge/Closed/Pair Wait</span> when winning tile can be considered as part of <span class="fan">Knitted Straight</span></label>
                                <label title="MIL規則採用。"><input type="radio" name="score-gb-setting-3" value="0" checked />Allow <span class="fan">Edge/Closed/Pair Wait</span> when winning tile can be considered as part of chow or pair</label>
                            </div>
                            <span>Multi-Wait</span>
                            <div class="output-option-group">
                                <label title="問答規則、世麻規則、MIL規則採用。疑難解析建議採用。"><input type="radio" name="score-gb-setting-4" value="0" checked />Omit <span class="fan">Edge/Closed/Pair Wait</span></label>
                                <label><input type="radio" name="score-gb-setting-4" value="26" />Allow <span class="fan">Edge/Closed/Pair Wait</span></label>
                            </div>
                            <span><span class="fan">Melded Hand</span></span>
                            <div class="output-option-group">
                                <label><input type="radio" name="score-gb-setting-7" value="0" checked />Extended Kong allowed</label>
                                <label><input type="radio" name="score-gb-setting-7" value="36" />Extended Kong banned</label>
                            </div>
                            <span>Payment Method</span>
                            <div class="output-option-group">
                                <label>Minimum limit <input type="number" id="score-gb-setting-fan" value="8" min="0" /> points</label>
                                <label>Extra points <input type="number" id="score-gb-setting-blind" value="8" min="0" /> points</label>
                                <label title="JMSA規則採用 88 台封頂。"><input type="checkbox" name="score-gb-setting" value="38" />Maximum limit <input type="number" id="score-gb-setting-maxfan" value="88" min="0" /> points</label>
                                <label><input type="checkbox" name="score-gb-setting" value="39" />Points divided by 3 when self-drawn</label>
                            </div>
                        </div>
                    </details>
                </div>
                <div class="output-context" id="output-score-gb"></div>
                <div class="output-context" id="brief-output-score-gb" style="display: none"></div>
                <div class="output-time" id="time-output-score-gb">Ready to start!</div>
            </div>
            <div class="output-box" id="score-jp">
                <div class="title-button-container">
                    <div class="output-title">Japanese Riichi Mahjong (RCR) Scores Calculator</div>
                    <button class="toggle-button" id="toggle-output-score-jp" onclick="toggleOutput(5)">Fold ▲</button>
                </div>
                <div id="options-output-score-jp">
                    <div class="output-options">
                        <span>Prevailing</span>
                        <div class="output-option-group">
                            <label><input type="radio" name="score-jp-global-wind" value="27" checked>East</label>
                            <label><input type="radio" name="score-jp-global-wind" value="28">South</label>
                            <label><input type="radio" name="score-jp-global-wind" value="29">West</label>
                            <label><input type="radio" name="score-jp-global-wind" value="30">North</label>
                        </div>
                        <span>Seat</span>
                        <div class="output-option-group">
                            <label><input type="radio" name="score-jp-local-wind" value="27" checked>East</label>
                            <label><input type="radio" name="score-jp-local-wind" value="28">South</label>
                            <label><input type="radio" name="score-jp-local-wind" value="29">West</label>
                            <label><input type="radio" name="score-jp-local-wind" value="30">North</label>
                        </div>
                        <span>Winning Way</span>
                        <div class="output-option-group">
                            <label><input type="radio" name="score-jp-wintype" value="0" checked>Claim</label>
                            <label><input type="radio" name="score-jp-wintype" value="1">Draw</label>
                        </div>
                        <span>Riichi Status</span>
                        <div class="output-option-group">
                            <label><input type="checkbox" name="score-jp-wininfo" value="1">Riichi</label>
                            <label><input type="checkbox" name="score-jp-wininfo" value="16">Double Riichi</label>
                            <label><input type="checkbox" name="score-jp-wininfo" value="3">Ippatsu</label>
                        </div>
                        <span>Winning Status</span>
                        <div class="output-option-group">
                            <label><input type="checkbox" name="score-jp-wininfo" value="32">First Turn</label>
                            <label><input type="checkbox" name="score-jp-wininfo" value="13">Last Tile</label>
                            <label><input type="checkbox" name="score-jp-wininfo" value="12">After a Kong</label>
                            <label><input type="checkbox" name="score-jp-wininfo" value="15">Robbing the Kong</label>
                        </div>
                        <button onclick="processJPScore()" class="score-button">Calculate</button>
                    </div>
                    <details>
                        <summary>Rules Settings</summary>
                        <div class="output-options">
                            <span>Yakuman</span>
                            <div class="output-option-group">
                                <label title="Used in XJTU Rules. Unused in JPML Rules, Saikouisen Rules, ClubJPM Rules, M.League, XJTU 7-stars and EMA Rules."><input type="checkbox" name="score-jp-setting" value="1" checked />Double Yakuman</label>
                                <label title="Used in JPML Rules, Saikouisen Rules, ClubJPM Rules, M.League and XJTU Rules. Unused in XJTU 7-stars and EMA Rules."><input type="checkbox" name="score-jp-setting" value="2" checked />Cumulative Yakuman</label>
                                <label title="Unused in Saikouisen Rules, ClubJPM Rules, M.League and EMA Rules."><input type="checkbox" name="score-jp-setting" value="3" checked />Counted Yakuman</label>
                            </div>
                            <span>Double Wind Pair</span>
                            <div class="output-option-group">
                                <label title="Used in MahjongSoul and XJTU Rules."><input type="radio" name="score-jp-setting-1" value="0" checked />4 Minipoints</label>
                                <label title="Used in JPML Rules, Saikouisen Rules, ClubJPM Rules and M.League."><input type="radio" name="score-jp-setting-1" value="5" />2 Minipoints</label>
                            </div>
                            <span>Rounded-up Mangan</span>
                            <div class="output-option-group">
                                <label title="Used in JPML WRC Rules, Saikouisen Rules, ClubJPM Rules and M.League. Unused in JPML Official Rules and Saikouisen Classic Rules."><input type="radio" name="score-jp-setting-3" value="7" />ON</label>
                                <label><input type="radio" name="score-jp-setting-3" value="0" checked />OFF</label>
                            </div>
                            <span>Open All Simples</span>
                            <div class="output-option-group">
                                <label><input type="radio" name="score-jp-setting-0" value="4" checked />ON</label>
                                <label><input type="radio" name="score-jp-setting-0" value="0" />OFF</label>
                            </div>
                            <span>Self-drawn Pinfu</span>
                            <div class="output-option-group">
                                <label><input type="radio" name="score-jp-setting-2" value="6" checked />Pinfu Yaku</label>
                                <label><input type="radio" name="score-jp-setting-2" value="0" />Self-draw Minipoints</label>
                            </div>
                            <span>Seven Pairs</span>
                            <div class="output-option-group">
                                <label><input type="radio" name="score-jp-setting-4" value="0" checked />2 Fan 25 Minipoints</label>
                                <label><input type="radio" name="score-jp-setting-4" value="8,1" />1 Fan 50 Minipoints</label>
                                <label><input type="radio" name="score-jp-setting-4" value="8,2" />0 Fan 100 Minipoints</label>
                            </div>
                            <span>After a Kong</span>
                            <div class="output-option-group">
                                <label><input type="radio" name="score-jp-setting-10" value="0" checked />Add Self-draw Minipoints</label>
                                <label><input type="radio" name="score-jp-setting-10" value="16" />Omit Self-draw Minipoints</label>
                            </div>
                            <span>Fan Limit</span>
                            <div class="output-option-group">
                                <label><input type="number" id="score-jp-setting-fan" value="1" min="0" /> Fan Limit</label>
                                <label><input type="checkbox" name="score-jp-setting-7" value="11" />Yakuman Limit</label>
                                <label><input type="checkbox" name="score-jp-setting-7" value="12" />Front Dora Included</label>
                                <label title="Used in Mahjong Han Limit Mode."><input type="checkbox" name="score-jp-setting-7" value="13" checked/>Ippatsu Included</label>
                            </div>
                            <span>Blessing of Man</span>
                            <div class="output-option-group">
                                <label><input type="radio" name="score-jp-setting-5" value="0" />OFF</label>
                                <label title="Used in JPML Rules, XJTU Rules and EMA Rules."><input type="radio" name="score-jp-setting-5" value="9,1" checked />5 Fan</label>
                                <label title="Used in MahjongSoul Local Yaku Mode."><input type="radio" name="score-jp-setting-5" value="9,2" />Yakuman</label>
                            </div>
                            <span>Big Seven Stars</span>
                            <div class="output-option-group">
                                <label><input type="radio" name="score-jp-setting-6" value="0" />Yakuman</label>
                                <label title="Used in XJTU Rules and MahjongSoul Local Yaku Mode."><input type="radio" name="score-jp-setting-6" value="10" checked />Double Yakuman</label>
                            </div>
                            <span>三連刻</span>
                            <div class="output-option-group">
                                <label><input type="radio" name="score-jp-setting-13" value="0" checked />なし</label>
                                <label><input type="radio" name="score-jp-setting-13" value="19" />2 飜</label>
                            </div>
                            <span>四連刻</span>
                            <div class="output-option-group">
                                <label><input type="radio" name="score-jp-setting-14" value="0" checked />なし</label>
                                <label><input type="radio" name="score-jp-setting-14" value="20" />役満</label>
                            </div>
                            <span>三色通貫</span>
                            <div class="output-option-group">
                                <label><input type="radio" name="score-jp-setting-11" value="0" checked />なし</label>
                                <label><input type="radio" name="score-jp-setting-11" value="17" />2 飜・食い下がり</label>
                            </div>
                            <span>一色三順</span>
                            <div class="output-option-group">
                                <label><input type="radio" name="score-jp-setting-15" value="0" checked />なし</label>
                                <label><input type="radio" name="score-jp-setting-15" value="21,1" />2 飜</label>
                                <label><input type="radio" name="score-jp-setting-15" value="21,2" />2 飜・食い下がり</label>
                                <label><input type="radio" name="score-jp-setting-15" value="21,3" />3 飜・食い下がり</label>
                                <label><input type="radio" name="score-jp-setting-15" value="21,4" />2 飜・門前のみ</label>
                                <label><input type="radio" name="score-jp-setting-15" value="21,5" />3 飜・門前のみ</label>
                            </div>
                            <span>一色四順</span>
                            <div class="output-option-group">
                                <label><input type="radio" name="score-jp-setting-16" value="0" checked />なし</label>
                                <label><input type="radio" name="score-jp-setting-16" value="22,1" />役満</label>
                                <label><input type="radio" name="score-jp-setting-16" value="22,2" />役満・門前のみ</label>
                                <label><input type="checkbox" name="score-jp-setting" value="23" checked />四連太宝と呼ぶ</label>
                            </div>
                            <span>発なし緑一色</span>
                            <div class="output-option-group">
                                <label><input type="radio" name="score-jp-setting-12" value="18,1" />なし</label>
                                <label><input type="radio" name="score-jp-setting-12" value="0" checked />役満</label>
                                <label><input type="radio" name="score-jp-setting-12" value="18,2" />ダブル役満</label>
                            </div>
                            <span>Minipoints Jumping</span>
                            <div class="output-option-group">
                                <label><input type="radio" name="score-jp-setting-8" value="14" checked />ON</label>
                                <label><input type="radio" name="score-jp-setting-8" value="0" />OFF</label>
                            </div>
                            <span>Scores Rounding up</span>
                            <div class="output-option-group">
                                <label><input type="radio" name="score-jp-setting-9" value="15" checked />ON</label>
                                <label><input type="radio" name="score-jp-setting-9" value="0" />OFF</label>
                            </div>
                        </div>
                    </details>
                    <div class="output-options">
                        <span>Dora Indicator</span>
                        <div class="card-container" id="output-pic-doras" style="text-align: left"></div>
                        <span>Ura Dora Indicator</span>
                        <div class="card-container" id="output-pic-uras" style="text-align: left"></div>
                    </div>
                </div>
                <div class="output-context" id="output-score-jp"></div>
                <div class="output-context" id="brief-output-score-jp" style="display: none"></div>
                <div class="output-time" id="time-output-score-jp">Ready to start!</div>
            </div>
            <div class="reference-box mobile-display-only" id="title-box"></div>
            <div class="reference-box">
                Related Rules:
                <ul style="margin-top: 0">   
                    <li><a href="./rules/Renmei.pdf">Japan Professional Mahjong League Official Rules and WRC Rules (JPML Rules)</a></li>
                    <li><a href="./rules/Achieve/Saikouisen.html">Saikouisen Nihon Pro Mahjong Association Competition Rules (Saikouisen Rules)</a></li>
                    <li><a href="./rules/Achieve/ClubJPM.html">Nihon Pro Mahjong Association Competition Rules (ClubJPM Rules)</a></li>
                    <li><a href="./rules/Achieve/MLeague.html">M.League Official Match Rules (M.League)</a></li>
                    <li><a href="./rules/XJTU-Riichi.pdf">Xi’an Jiaotong University Riichi Mahjong Competition Rules (XJTU Rules) and Xi’an Jiaotong University Seven Stars Cup Riichi Mahjong Open Tournament Rules (XJTU 7-stars)</a></li>
                    <li><a href="./rules/EMA-Riichi.pdf">European Mahjong Association Riichi Rules (EMA rules)</a></li>
                </ul>
            </div>
        </div>
        <div class="section title-button-container">
            <div class="output-time">v4.5.0</div>
        </div>
        <script src="mahjong.js"></script>
        <script src="mahjong-document.js"></script>
        <script>
            function tilesInfo(tcnt) {
                const meld = Math.floor(tcnt / 3);
                let output = `${tcnt} tiles\n`;
                switch (tcnt % 3) {
                    case 1:
                        output += `3n+1 Type: Winning needs ${meld} melds and ${1} pairs`;
                        break;
                    case 2:
                        output += `3n+2 Type: Winning needs ${meld} melds and ${1} pairs`;
                        break;
                    case 0:
                        output += `3n Type: Winning needs ${meld} melds and ${0} pairs`;
                        break;
                }
                return output;
            }
            function toggleInput() {
                const board = document.getElementById("boardInput");
                const button = document.getElementById("inputButton");
                const text = document.getElementById("textInput");
                const isVisible = board.style.display !== "none";
                board.style.display = isVisible ? "none" : "block";
                text.style.display = isVisible ? "block" : "none";
                button.textContent = isVisible ? "Open Input Panel ▼" : "Close Input Panel ▲";
                if (!isVisible) drawInputCards();
                if (!isVisible) adjustButtonsFontSize();
            }
            function toggleNote() {
                const note = document.getElementById("inputNote");
                const button = document.getElementById("inputNoteButton");
                const isVisible = note.style.display !== "none";
                note.style.display = isVisible ? "none" : "block";
                button.textContent = isVisible ? "Show input instructions ▼" : "Hide input instructions ▲";
            }
            function toggleOutput(i) {
                const ids = ["output-std", "output-gb", "output-jp", "output-tw", "output-score-gb", "output-score-jp"];
                const d = document.getElementById(ids[i]);
                const b = document.getElementById("toggle-" + ids[i]);
                const s = document.getElementById("brief-" + ids[i]);
                const o = document.getElementById("options-" + ids[i]);
                const v = d.style.display !== "none";
                d.style.display = v ? "none" : "block";
                s.style.display = v ? "block" : "none";
                if (o) o.style.display = v ? "none" : "block";
                b.textContent = v ? "Expand ▼" : "Fold ▲";
                addWorkerCardHelper();
            }
            window.onload = function () {
                loadStorage();
                addReferenceMark();
                randomInput();
            };
            const lang = "en";
            const card_helper = true;
        </script>
    </body>
</html>
