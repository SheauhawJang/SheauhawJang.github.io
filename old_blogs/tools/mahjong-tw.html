<!DOCTYPE html>
<html lang="zh-TW">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <meta name="description" content="支援十六張麻將、港式台灣麻將、立直麻將、十三張麻將一般型、國標麻將以及任意張麻將的牌理向聽數計算。支援百搭牌（萬能牌/癩子/混兒）。支援國標麻將台數計算、立直麻將分數計算。">
        <title>麻將多功能計算機</title>
        <link rel="stylesheet" href="mahjong.css" />
    </head>

    <body>
        <div class="language-bar">
            <div class="language-bar-group">
                <a onclick="updateCardSkin('jp')">雀魂牌畫</a>
                <a onclick="updateCardSkin('gb')">雀渣牌畫</a>
                <a onclick="updateCardSkin('qq')">騰訊牌畫</a>
                <a onclick="updateCardSkin('hk')">開枱喇牌畫</a>
            </div>
            <div class="language-bar-group">
                <a href="mahjong.html">简体中文</a>
                <a>正體中文</a>
                <a href="mahjong-ja.html">日本語</a>
                <a href="mahjong-en.html">English</a>
            </div>
        </div>
        <h1>麻將多功能計算機</h1>
        <ul class="input-note-wrapper" style="padding-left: 1.5em; margin-left: 0;">
            <li>支援十六張麻將、港式台灣麻將、立直麻將、十三張麻將一般型、國標麻將以及任意張麻將的牌理向聽數計算。</li>
            <li>支援百搭牌（萬能牌/癩子/混兒）。</li>
            <li>支援國標麻將台數計算、立直麻將分數計算。</li>
        </ul>
        <div class="section">
            <div class="title-button-container">
                <label for="inputText">請輸入手牌</label>
                <button class="toggle-button" id="inputButton" onclick="toggleInput()" style="color: #f58c8a">開啟輸入面板 ▼</button>
            </div>
            <div class="input-area" id="textInput">
                <input type="text" id="inputText" placeholder="例如：1112345678999mE" />
                <div class="input-note-wrapper">
                    <button class="toggle-button" id="inputNoteButton" onclick="toggleNote()" style="color: #4caf50">顯示輸入說明 ▼</button>
                    <div class="input-note" id="inputNote" style="display: none">
                        輸入欄支援以下格式，以下格式可混合使用：
                        <ol style="margin-top: 0">
                            <li>
                                天鳳格式：序數牌使用序數(阿拉伯數字)＋顏色(小寫字母)表示，其中：<b>萬=m</b>，<b>索/條=s</b>，<b>筒/餅=p</b>。字牌之<b>東南西北白發中</b>依次使用<b>1z2z3z4z5z6z7z</b>表示。同字母後綴的相鄰牌可以只保留最右側牌的字母後綴。
                            </li>
                            <li>國標小助手格式：序數牌同「天鳳格式」，字牌之<b>東南西北白發中</b>依次使用大寫字母<b>ESWNPFC</b>表示。</li>
                            <li>英文麻將印刷格式：序數牌同「天鳳格式」，字牌之<b>東南西北</b>依次使用大寫字母<b>ESWN</b>表示，<b>白=Wh</b>，<b>發=G</b>，<b>中=R</b>。</li>
                            <li>漢語拼音格式：同天鳳格式。惟<b>萬=w</b>，<b>餅/筒=b</b>。</li>
                            <li>
                                採譜記號格式：萬字使用漢數字<b>一二三四五六七八九</b>表示，筒子/餅子使用帶圈數字<b>①②③④⑤⑥⑦⑧⑨</b>表示，索子/條子使用全形數字<b>１２３４５６７８９</b>表示，字牌使用對應漢字表示。
                            </li>
                            <li>Unicode格式：使用Unicode U+1F000 至 U+1F02B 的字符表示對應的牌。</li>
                        </ol>
                        <p>
                            關於花牌：<b>春夏秋冬梅蘭菊竹</b>依次使用<b>1h2h3h4h5h6h7h8h</b>或<b>1f2f3f4f5f6f7f8f</b>表示。部分地方麻將把花牌視作百搭牌，本計算器的花牌無此功能，如有需要請轉化為專門的百搭牌。<br />
                        </p>
                        關於百搭牌：
                        <ul style="margin-top: 0">
                            <li>
                                不定向百搭牌
                                <img
                                    src="./cards/a1j.gif"
                                    style="vertical-align: middle"
                                />：可以視作任何一張序數牌或字牌。使用<b>1j/J</b>表示。（部分地方麻將可能稱為癩子或者混兒）
                            </li>
                            <li>萬字百搭牌 <img src="./cards/a2j.gif" style="vertical-align: middle" />：可以視作任何一張萬字。使用<b>2j/im/iw</b>表示。</li>
                            <li>餅子百搭牌 <img src="./cards/a3j.gif" style="vertical-align: middle" />：可以視作任何一張筒子/餅子。使用<b>3j/ip/ib</b>表示。</li>
                            <li>索子百搭牌 <img src="./cards/a4j.gif" style="vertical-align: middle" />：可以視作任何一張索子/條子。使用<b>4j/is</b>表示。</li>
                            <li>數牌百搭牌 <img src="./cards/a5j.gif" style="vertical-align: middle" />：可以視作任何一張序數牌。使用<b>5j</b>表示。</li>
                            <li>風牌百搭牌 <img src="./cards/a6j.gif" style="vertical-align: middle" />：可以視作<b>東南西北</b>中的任何一張。使用<b>6j</b>表示。</li>
                            <li>三元百搭牌 <img src="./cards/a7j.gif" style="vertical-align: middle" />：可以視作<b>白發中</b>中的任何一張。使用<b>7j</b>表示。</li>
                            <li>字牌百搭牌 <img src="./cards/a8j.gif" style="vertical-align: middle" />：可以視作任何一張字牌。使用<b>8j/iz</b>表示。</li>
                            <li>花牌百搭牌 <img src="./cards/a9j.gif" style="vertical-align: middle" />：可以視作任何一張花牌。使用<b>9j/H/X/9h/9f/ih/if</b>表示。</li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="input-area" id="boardInput" style="display: none">
                <div class="card-container" id="input-pic"></div>
                <div class="input-keyboard">
                    <div class="input-mainkey">
                        <div class="input-row">
                            <div></div>
                            <div class="card-div input-card-button"><img src="./cards/1m.gif" onclick="addInput(0)" /></div>
                            <div class="card-div input-card-button"><img src="./cards/2m.gif" onclick="addInput(1)" /></div>
                            <div class="card-div input-card-button"><img src="./cards/3m.gif" onclick="addInput(2)" /></div>
                            <div class="card-div input-card-button"><img src="./cards/4m.gif" onclick="addInput(3)" /></div>
                            <div class="card-div input-card-button"><img src="./cards/5m.gif" onclick="addInput(4)" /></div>
                            <div class="card-div input-card-button"><img src="./cards/6m.gif" onclick="addInput(5)" /></div>
                            <div class="card-div input-card-button"><img src="./cards/7m.gif" onclick="addInput(6)" /></div>
                            <div class="card-div input-card-button"><img src="./cards/8m.gif" onclick="addInput(7)" /></div>
                            <div class="card-div input-card-button"><img src="./cards/9m.gif" onclick="addInput(8)" /></div>
                            <div class="card-div input-card-button"><img src="./cards/0m.gif" onclick="addInput({ id: 4, sp: 1 })" /></div>
                            <div></div>
                        </div>
                        <div class="input-row">
                            <div></div>
                            <div class="card-div input-card-button"><img src="./cards/1p.gif" onclick="addInput(9)" /></div>
                            <div class="card-div input-card-button"><img src="./cards/2p.gif" onclick="addInput(10)" /></div>
                            <div class="card-div input-card-button"><img src="./cards/3p.gif" onclick="addInput(11)" /></div>
                            <div class="card-div input-card-button"><img src="./cards/4p.gif" onclick="addInput(12)" /></div>
                            <div class="card-div input-card-button"><img src="./cards/5p.gif" onclick="addInput(13)" /></div>
                            <div class="card-div input-card-button"><img src="./cards/6p.gif" onclick="addInput(14)" /></div>
                            <div class="card-div input-card-button"><img src="./cards/7p.gif" onclick="addInput(15)" /></div>
                            <div class="card-div input-card-button"><img src="./cards/8p.gif" onclick="addInput(16)" /></div>
                            <div class="card-div input-card-button"><img src="./cards/9p.gif" onclick="addInput(17)" /></div>
                            <div class="card-div input-card-button"><img src="./cards/0p.gif" onclick="addInput({ id: 13, sp: 1 })" /></div>
                            <div></div>
                        </div>
                        <div class="input-row">
                            <div></div>
                            <div class="card-div input-card-button"><img src="./cards/1s.gif" onclick="addInput(18)" /></div>
                            <div class="card-div input-card-button"><img src="./cards/2s.gif" onclick="addInput(19)" /></div>
                            <div class="card-div input-card-button"><img src="./cards/3s.gif" onclick="addInput(20)" /></div>
                            <div class="card-div input-card-button"><img src="./cards/4s.gif" onclick="addInput(21)" /></div>
                            <div class="card-div input-card-button"><img src="./cards/5s.gif" onclick="addInput(22)" /></div>
                            <div class="card-div input-card-button"><img src="./cards/6s.gif" onclick="addInput(23)" /></div>
                            <div class="card-div input-card-button"><img src="./cards/7s.gif" onclick="addInput(24)" /></div>
                            <div class="card-div input-card-button"><img src="./cards/8s.gif" onclick="addInput(25)" /></div>
                            <div class="card-div input-card-button"><img src="./cards/9s.gif" onclick="addInput(26)" /></div>
                            <div class="card-div input-card-button"><img src="./cards/0s.gif" onclick="addInput({ id: 22, sp: 1 })" /></div>
                            <div></div>
                        </div>
                        <div class="input-row">
                            <div></div>
                            <div class="card-div input-card-button"><img src="./cards/1z.gif" onclick="addInput(27)" /></div>
                            <div class="card-div input-card-button"><img src="./cards/2z.gif" onclick="addInput(28)" /></div>
                            <div class="card-div input-card-button"><img src="./cards/3z.gif" onclick="addInput(29)" /></div>
                            <div class="card-div input-card-button"><img src="./cards/4z.gif" onclick="addInput(30)" /></div>
                            <div class="card-div input-card-button"><img src="./cards/5z.gif" onclick="addInput(31)" /></div>
                            <div class="card-div input-card-button"><img src="./cards/6z.gif" onclick="addInput(32)" /></div>
                            <div class="card-div input-card-button"><img src="./cards/7z.gif" onclick="addInput(33)" /></div>
                            <div class="card-div input-card-button"><img src="./cards/0z.gif" onclick="addInput({ id: 31, sp: 1 })" /></div>
                            <div></div>
                        </div>
                        <div class="input-row">
                            <div></div>
                            <div class="card-div input-card-button"><img src="./cards/1h.gif" onclick="addInput(34)" /></div>
                            <div class="card-div input-card-button"><img src="./cards/2h.gif" onclick="addInput(35)" /></div>
                            <div class="card-div input-card-button"><img src="./cards/3h.gif" onclick="addInput(36)" /></div>
                            <div class="card-div input-card-button"><img src="./cards/4h.gif" onclick="addInput(37)" /></div>
                            <div class="card-div input-card-button"><img src="./cards/5h.gif" onclick="addInput(38)" /></div>
                            <div class="card-div input-card-button"><img src="./cards/6h.gif" onclick="addInput(39)" /></div>
                            <div class="card-div input-card-button"><img src="./cards/7h.gif" onclick="addInput(40)" /></div>
                            <div class="card-div input-card-button"><img src="./cards/8h.gif" onclick="addInput(41)" /></div>
                            <div></div>
                        </div>
                        <div class="input-row">
                            <div></div>
                            <div class="card-div input-card-button"><img src="./cards/1j.gif" onclick="addInput(42)" /></div>
                            <div class="card-div input-card-button"><img src="./cards/2j.gif" onclick="addInput(43)" /></div>
                            <div class="card-div input-card-button"><img src="./cards/3j.gif" onclick="addInput(44)" /></div>
                            <div class="card-div input-card-button"><img src="./cards/4j.gif" onclick="addInput(45)" /></div>
                            <div class="card-div input-card-button"><img src="./cards/5j.gif" onclick="addInput(46)" /></div>
                            <div class="card-div input-card-button"><img src="./cards/6j.gif" onclick="addInput(47)" /></div>
                            <div class="card-div input-card-button"><img src="./cards/7j.gif" onclick="addInput(48)" /></div>
                            <div class="card-div input-card-button"><img src="./cards/8j.gif" onclick="addInput(49)" /></div>
                            <div class="card-div input-card-button"><img src="./cards/9j.gif" onclick="addInput(50)" /></div>
                            <div></div>
                        </div>
                        <div class="card-container" id="input-pic-bonus"></div>
                        <div class="output-options">
                            <span>加分牌指示牌</span>
                            <div class="card-container" id="input-pic-dorap"></div>
                            <span>裡加分牌指示牌</span>
                            <div class="card-container" id="input-pic-urap"></div>
                        </div>
                    </div>
                    <div class="input-subkeys">
                        <button onclick="clearInput()" class="subkey-button">清空</button>
                        <button onclick="sortInput()" class="subkey-button">理牌</button>
                        <button onclick="removeInput(ipids[0].length - 1, -1)" class="subkey-button enable-no-empty">退格</button>
                        <button onclick="subtileInput(0)" class="subkey-button" id="subkey_chi">吃</button>
                        <button onclick="subtileInput(1)" class="subkey-button enabled-no-flower">碰</button>
                        <button onclick="subtileInput(2, 1)" class="subkey-button enabled-no-flower">明槓</button>
                        <button onclick="subtileInput(2, 5)" class="subkey-button enabled-no-flower">加槓</button>
                        <button onclick="subtileInput(2, 0)" class="subkey-button enabled-no-flower">暗槓</button>
                        <button onclick="subtileInput(3)" class="subkey-button enable-no-empty">補花</button>
                        <button onclick="subtileInput(4)" class="subkey-button enable-no-empty">加分牌指示</button>
                        <button onclick="subtileInput(5)" class="subkey-button enable-no-empty">裡加分牌指示</button>
                    </div>
                </div>
            </div>
            <div style="text-align: center">
                <button onclick="processInput()" class="random-button">計算</button>
                <button onclick="randomInput()" class="random-button">隨機生成 <input type="number" id="randomCardCount" value="17" min="1" max="99" /> 張牌</button>
            </div>
            <div class="output-box-head">
                <div class="output-context" style="text-align: center" id="output-cnt"></div>
                <div class="card-container" id="output-pic"></div>
                <div class="card-container" id="output-pic-bonus" style="text-align: right;"></div>
            </div>
            <div class="output-box">
                <div class="title-button-container">
                    <div class="output-title">一般型牌理</div>
                    <button class="toggle-button" id="toggle-output-std" onclick="toggleOutput(0)">摺疊 ▲</button>
                </div>
                <div class="output-context" id="output-std"></div>
                <div class="output-context" id="brief-output-std" style="display: none"></div>
                <div class="output-time" id="time-output-std"></div>
            </div>
            <div class="output-box">
                <div class="title-button-container">
                    <div class="output-title">港式台灣麻將牌理</div>
                    <button class="toggle-button" id="toggle-output-tw" onclick="toggleOutput(3)">摺疊 ▲</button>
                </div>
                <div class="output-option-group">
                    <label><input type="checkbox" name="step-tw-types" value="0" onchange="restartInput(3)" checked />一般型</label>
                    <label><input type="checkbox" name="step-tw-types" value="1" onchange="restartInput(3)" checked />嚦咕嚦咕型</label>
                    <label><input type="checkbox" name="step-tw-types" value="2" onchange="restartInput(3)" checked />十三么型</label>
                    <label><input type="checkbox" name="step-tw-types" value="3" onchange="restartInput(3)" checked />十六不搭型</label>
                </div>
                <div class="output-context" id="output-tw"></div>
                <div class="output-context" id="brief-output-tw" style="display: none"></div>
                <div class="output-time" id="time-output-tw"></div>
            </div>
            <div class="output-box">
                <div class="title-button-container">
                    <div class="output-title">
                        立直麻將標準型牌理
                        <button id="mySwitch" class="switch on" aria-pressed="true" onclick="toggleSwitch(event, '四人', '三人', switchJP34)">
                            <span class="label-text">四人</span>
                            <span class="thumb"></span>
                        </button>
                    </div>
                    <button class="toggle-button" id="toggle-output-jp" onclick="toggleOutput(2); toggleOutput(7);">摺疊 ▲</button>
                    <button class="toggle-button" id="toggle-output-jp3p" style="display: none;">摺疊 ▲</button>
                </div>
                <div class="output-option-group">
                    <label><input type="checkbox" name="step-jp-types" value="0" onchange="restartInput(1); restartInput(4)" checked />一般型</label>
                    <label><input type="checkbox" name="step-jp-types" value="1" onchange="restartInput(1); restartInput(4)" checked />七對型</label>
                    <label><input type="checkbox" name="step-jp-types" value="2" onchange="restartInput(1); restartInput(4)" checked />國士無雙型</label>
                </div>
                <div id="output-group-jp">
                    <div class="output-context" id="output-jp"></div>
                    <div class="output-context" id="brief-output-jp" style="display: none"></div>
                    <div class="output-time" id="time-output-jp"></div>
                </div>
                <div id="output-group-jp3p" style="display: none;">
                    <div class="output-context" id="output-jp3p"></div>
                    <div class="output-context" id="brief-output-jp3p" style="display: none"></div>
                    <div class="output-time" id="time-output-jp3p"></div>
                </div>
            </div>
            <div class="output-box">
                <div class="title-button-container">
                    <div class="output-title">國標麻將標準型牌理</div>
                    <button class="toggle-button" id="toggle-output-gb" onclick="toggleOutput(1)">摺疊 ▲</button>
                </div>
                <div class="output-option-group">
                    <label><input type="checkbox" name="step-gb-types" value="0" onchange="restartInput(2)" checked />一般型</label>
                    <label><input type="checkbox" name="step-gb-types" value="1" onchange="restartInput(2)" checked />七對型</label>
                    <label><input type="checkbox" name="step-gb-types" value="2" onchange="restartInput(2)" checked />十三么型</label>
                    <label><input type="checkbox" name="step-gb-types" value="3" onchange="restartInput(2)" checked />全不靠型</label>
                    <label><input type="checkbox" name="step-gb-types" value="4" onchange="restartInput(2)" checked />組合龍型</label>
                </div>
                <div class="output-context" id="output-gb"></div>
                <div class="output-context" id="brief-output-gb" style="display: none"></div>
                <div class="output-time" id="time-output-gb"></div>
            </div>
            <div class="output-box" id="score-jp">
                <div class="title-button-container">
                    <div class="output-title">立直麻將分數計算器</div>
                    <button class="toggle-button" id="toggle-output-score-jp" onclick="toggleOutput(5)">摺疊 ▲</button>
                </div>
                <div id="options-output-score-jp">
                    <div class="output-options">
                        <span>場風</span>
                        <div class="output-option-group">
                            <label><input type="radio" name="score-jp-global-wind" value="27" checked>東</label>
                            <label><input type="radio" name="score-jp-global-wind" value="28">南</label>
                            <label><input type="radio" name="score-jp-global-wind" value="29">西</label>
                            <label><input type="radio" name="score-jp-global-wind" value="30">北</label>
                        </div>
                        <span>自風</span>
                        <div class="output-option-group">
                            <label><input type="radio" name="score-jp-local-wind" value="27" checked>東</label>
                            <label><input type="radio" name="score-jp-local-wind" value="28">南</label>
                            <label><input type="radio" name="score-jp-local-wind" value="29">西</label>
                            <label><input type="radio" name="score-jp-local-wind" value="30">北</label>
                        </div>
                        <span>和牌方式</span>
                        <div class="output-option-group">
                            <label><input type="radio" name="score-jp-wintype" value="0" checked>榮和</label>
                            <label><input type="radio" name="score-jp-wintype" value="1">自摸</label>
                        </div>
                        <span>立直狀態</span>
                        <div class="output-option-group">
                            <label><input type="checkbox" name="score-jp-wininfo" value="1">立直</label>
                            <label><input type="checkbox" name="score-jp-wininfo" value="16">兩立直</label>
                            <label><input type="checkbox" name="score-jp-wininfo" value="3">一發</label>
                        </div>
                        <span>和牌狀態</span>
                        <div class="output-option-group">
                            <label><input type="checkbox" name="score-jp-wininfo" value="32">第一巡目</label>
                            <label><input type="checkbox" name="score-jp-wininfo" value="13">最後一張</label>
                            <label><input type="checkbox" name="score-jp-wininfo" value="12">嶺上開花</label>
                            <label><input type="checkbox" name="score-jp-wininfo" value="15">搶槓</label>
                        </div>
                        <button onclick="processJPScore()" class="score-button">計算</button>
                    </div>
                    <details>
                        <summary>規則設定</summary>
                        <div class="output-options">
                            <span>役滿</span>
                            <div class="output-option-group">
                                <label title="XJTU規則採用。聯盟規則、最高位戰規則、協會規則、M.League、XJTU七星杯、EMA規則不採用。"><input type="checkbox" name="score-jp-setting" value="1" checked />雙倍役滿</label>
                                <label title="聯盟規則、最高位戰規則、協會規則、M.League、XJTU規則採用。XJTU七星杯、EMA規則不採用。"><input type="checkbox" name="score-jp-setting" value="2" checked />複合役滿</label>
                                <label title="最高位戰規則、協會規則、M.League、EMA規則不採用。"><input type="checkbox" name="score-jp-setting" value="3" checked />累計役滿</label>
                            </div>
                            <span>連風牌雀頭</span>
                            <div class="output-option-group">
                                <label title="雀魂、天鳳、XJTU規則、EMA規則採用。"><input type="radio" name="score-jp-setting-1" value="0" checked />4 符</label>
                                <label title="聯盟規則、最高位戰規則、協會規則、M.League採用。"><input type="radio" name="score-jp-setting-1" value="5" />2 符</label>
                            </div>
                            <span>切上滿貫</span>
                            <div class="output-option-group">
                                <label title="聯盟WRC規則、最高位戰規則、協會規則、M.League採用。聯盟官方規則、最高位戰Classic規則不採用。"><input type="radio" name="score-jp-setting-3" value="7" />開啟</label>
                                <label><input type="radio" name="score-jp-setting-3" value="0" checked />關閉</label>
                            </div>
                            <span>食斷</span>
                            <div class="output-option-group">
                                <label><input type="radio" name="score-jp-setting-0" value="4" checked />開啟</label>
                                <label><input type="radio" name="score-jp-setting-0" value="0" />關閉</label>
                            </div>
                            <span>自摸平和</span>
                            <div class="output-option-group">
                                <label><input type="radio" name="score-jp-setting-2" value="6" checked />平和役</label>
                                <label><input type="radio" name="score-jp-setting-2" value="0" />自摸符</label>
                            </div>
                            <span>副露平和型</span>
                            <div class="output-option-group">
                                <label><input type="checkbox" name="score-jp-setting" value="24" />平和役</label>
                                <label><input type="checkbox" name="score-jp-setting" value="25" />允許 20 符</label>
                            </div>
                            <span>七對子</span>
                            <div class="output-option-group">
                                <label><input type="radio" name="score-jp-setting-4" value="0" checked />2 番 25 符</label>
                                <label><input type="radio" name="score-jp-setting-4" value="8,1" />1 番 50 符</label>
                                <label><input type="radio" name="score-jp-setting-4" value="8,2" />0 番 100 符</label>
                            </div>
                            <span>嶺上開花</span>
                            <div class="output-option-group">
                                <label><input type="radio" name="score-jp-setting-10" value="0" checked />有自摸符</label>
                                <label><input type="radio" name="score-jp-setting-10" value="16" />無自摸符</label>
                            </div>
                            <span>番縛</span>
                            <div class="output-option-group">
                                <label><input type="number" id="score-jp-setting-fan" value="1" min="0" />番縛</label>
                                <label><input type="checkbox" name="score-jp-setting-7" value="11" />役滿縛</label>
                                <label><input type="checkbox" name="score-jp-setting-7" value="12" />包含表加分牌</label>
                                <label title="雀魂番縛模式採用。"><input type="checkbox" name="score-jp-setting-7" value="13" checked/>包含一發</label>
                            </div>
                            <span>人和</span>
                            <div class="output-option-group">
                                <label><input type="radio" name="score-jp-setting-5" value="0" />關閉</label>
                                <label><input type="radio" name="score-jp-setting-5" value="9,3" />4 番</label>
                                <label title="聯盟規則、XJTU規則、EMA規則採用。"><input type="radio" name="score-jp-setting-5" value="9,1" checked />5 番</label>
                                <label><input type="radio" name="score-jp-setting-5" value="9,4" />6 番</label>
                                <label><input type="radio" name="score-jp-setting-5" value="9,5" />8 番</label>
                                <label title="雀魂古役模式採用。"><input type="radio" name="score-jp-setting-5" value="9,2" />役滿</label>
                                <label title="聯盟規則採用。"><input type="checkbox" name="score-jp-setting" value="21">不與通常役複合</label>
                            </div>
                            <span>大七星</span>
                            <div class="output-option-group">
                                <label><input type="radio" name="score-jp-setting-6" value="0" />役滿</label>
                                <label title="XJTU規則、雀魂古役模式採用。"><input type="radio" name="score-jp-setting-6" value="10" checked />雙倍役滿</label>
                            </div>
                            <span>三連刻</span>
                            <div class="output-option-group">
                                <label><input type="radio" name="score-jp-setting-13" value="0" checked />關閉</label>
                                <label><input type="radio" name="score-jp-setting-13" value="19" />2 番</label>
                            </div>
                            <span>四連刻</span>
                            <div class="output-option-group">
                                <label><input type="radio" name="score-jp-setting-14" value="0" checked />關閉</label>
                                <label><input type="radio" name="score-jp-setting-14" value="20" />役滿</label>
                            </div>
                            <span>三色通貫</span>
                            <div class="output-option-group">
                                <label><input type="radio" name="score-jp-setting-11" value="0" checked />關閉</label>
                                <label><input type="radio" name="score-jp-setting-11" value="17" />2 番食下</label>
                            </div>
                            <span>一色三順</span>
                            <div class="output-option-group">
                                <label><input type="radio" name="score-jp-setting-15" value="0" checked />關閉</label>
                                <label><input type="radio" name="score-jp-setting-15" value="21,1" />2 飜</label>
                                <label><input type="radio" name="score-jp-setting-15" value="21,2" />2 番食下</label>
                                <label><input type="radio" name="score-jp-setting-15" value="21,3" />3 番食下</label>
                                <label><input type="radio" name="score-jp-setting-15" value="21,4" />2 番門前</label>
                                <label><input type="radio" name="score-jp-setting-15" value="21,5" />3 番門前</label>
                            </div>
                            <span>一色四順</span>
                            <div class="output-option-group">
                                <label><input type="radio" name="score-jp-setting-16" value="0" checked />關閉</label>
                                <label><input type="radio" name="score-jp-setting-16" value="22,1" />役滿</label>
                                <label><input type="radio" name="score-jp-setting-16" value="22,2" />役滿門前</label>
                                <label><input type="checkbox" name="score-jp-setting" value="23" checked />使用役名四連太寶</label>
                            </div>
                            <span>無發綠一色</span>
                            <div class="output-option-group">
                                <label><input type="radio" name="score-jp-setting-12" value="18,1" />關閉</label>
                                <label><input type="radio" name="score-jp-setting-12" value="0" checked />役滿</label>
                                <label><input type="radio" name="score-jp-setting-12" value="18,2" />雙倍役滿</label>
                            </div>
                            <span>跳符</span>
                            <div class="output-option-group">
                                <label><input type="radio" name="score-jp-setting-8" value="14" checked />開啟</label>
                                <label><input type="radio" name="score-jp-setting-8" value="0" />關閉</label>
                            </div>
                            <span>分數上取整</span>
                            <div class="output-option-group">
                                <label><input type="radio" name="score-jp-setting-9" value="15" checked />開啟</label>
                                <label><input type="radio" name="score-jp-setting-9" value="0" />關閉</label>
                            </div>
                            <span>快捷設定</span>
                            <div class="output-option-group">
                                <button onclick="processJPSetting(0)">XJTU規則</button>
                                <button onclick="processJPSetting(1)">XJTU七星杯</button>
                                <button onclick="processJPSetting(2)">聯盟官方規則</button>
                                <button onclick="processJPSetting(3)">聯盟WRC規則</button>
                                <button onclick="processJPSetting(4)">最高位戰規則／協會規則／M.League</button>
                                <button onclick="processJPSetting(5)">最高位戰Classic規則</button>
                                <button onclick="processJPSetting(8)">EMA規則</button>
                                <button onclick="processJPSetting(9)">雀魂</button>
                                <button onclick="processJPSetting(10)">雀魂古役模式</button>
                                <button onclick="processJPSetting(11)">天鳳</button>
                            </div>
                        </div>
                    </details>
                    <div class="output-options">
                        <span>加分牌指示牌</span>
                        <div class="card-container" id="output-pic-doras" style="text-align: left"></div>
                        <span>裡加分牌指示牌</span>
                        <div class="card-container" id="output-pic-uras" style="text-align: left"></div>
                    </div>
                </div>
                <div class="output-context" id="output-score-jp"></div>
                <div class="output-context" id="brief-output-score-jp" style="display: none"></div>
                <div class="output-time" id="time-output-score-jp">Ready to start!</div>
            </div>
            <div class="output-box" id="score-gb" style="display: none;">
                <div class="title-button-container">
                    <div class="output-title">國標麻將台數計算器</div>
                    <button class="toggle-button" id="toggle-output-score-gb" onclick="toggleOutput(4)">摺疊 ▲</button>
                </div>
                <div id="options-output-score-gb">
                    <div class="output-options">
                        <span>圈風</span>
                        <div class="output-option-group">
                            <label><input type="radio" name="score-gb-global-wind" value="27" checked>東</label>
                            <label><input type="radio" name="score-gb-global-wind" value="28">南</label>
                            <label><input type="radio" name="score-gb-global-wind" value="29">西</label>
                            <label><input type="radio" name="score-gb-global-wind" value="30">北</label>
                        </div>
                        <span>門風</span>
                        <div class="output-option-group">
                            <label><input type="radio" name="score-gb-local-wind" value="27" checked>東</label>
                            <label><input type="radio" name="score-gb-local-wind" value="28">南</label>
                            <label><input type="radio" name="score-gb-local-wind" value="29">西</label>
                            <label><input type="radio" name="score-gb-local-wind" value="30">北</label>
                        </div>
                        <span>和牌方式</span>
                        <div class="output-option-group">
                            <label><input type="radio" name="score-gb-wintype" value="0" checked>點和</label>
                            <label><input type="radio" name="score-gb-wintype" value="80">自摸</label>
                        </div>
                        <span>和牌狀態</span>
                        <div class="output-option-group">
                            <label><input type="checkbox" name="score-gb-wininfo" value="44">最後一張</label>
                            <label><input type="checkbox" name="score-gb-wininfo" value="46">槓上開花</label>
                            <label><input type="checkbox" name="score-gb-wininfo" value="47">搶槓和</label>
                            <label><input type="checkbox" name="score-gb-wininfo" value="58">和絕張</label>
                        </div>
                        <button onclick="processGBScore()" class="score-button">計算</button>
                    </div>
                    <details>
                        <summary>規則設定</summary>
                        <div class="output-options">
                            <span title="國標原文的不求人定義限定一般型。問答規則、MIL規則、JMSA規則不允許不求人複合下述所有台種。世麻規則允許不求人複合下述所有台種。疑難解析建議允許不求人複合下述所有台種。">不求人複合</span>
                            <div class="output-option-group">
                                <label><input type="checkbox" name="score-gb-setting" value="19" />九蓮寶燈/四暗刻</label>
                                <label><input type="checkbox" name="score-gb-setting" value="41" />七對/連七對</label>
                                <label><input type="checkbox" name="score-gb-setting" value="42" />十三么</label>
                                <label><input type="checkbox" name="score-gb-setting" value="43" />全不靠/七星不靠</label>
                            </div>
                            <span title="國標原文的下述台種定義限定一般型，但包含了七對複合字一色、清么九的牌例。疑難解析允許七對複合清一色、混一色、五門齊。問答規則建議允許，MIL規則允許七對複合清一色至混么九。世麻規則允許七對複合清一色至五門齊。JMSA規則允許七對複合清一色至推不倒、字一色至混么九。">七對複合</span>
                            <div class="output-option-group">
                                <label><input type="checkbox" name="score-gb-setting" value="5" checked />清一色</label>
                                <label><input type="checkbox" name="score-gb-setting" value="10" checked />混一色</label>
                                <label><input type="checkbox" name="score-gb-setting" value="1" checked />綠一色</label>
                                <label><input type="checkbox" name="score-gb-setting" value="6" checked />全大/全中/全小</label>
                                <label><input type="checkbox" name="score-gb-setting" value="7" checked />大於五/小於五</label>
                                <label><input type="checkbox" name="score-gb-setting" value="9" checked />推不倒</label>
                                <label><input type="checkbox" name="score-gb-setting" value="11" checked />五門齊</label>
                                <label><input type="checkbox" name="score-gb-setting" value="3" checked />字一色</label>
                                <label><input type="checkbox" name="score-gb-setting" value="2" checked />清么九</label>
                                <label><input type="checkbox" name="score-gb-setting" value="4" checked />混么九</label>
                                <label><input type="checkbox" name="score-gb-setting" value="40" checked />全帯么</label>
                                <label title="由於張數限制，不可能出現。"><input type="checkbox" name="score-gb-setting" value="8" checked />全帶五</label>
                                <label title="現行規則均不允許。"><input type="checkbox" name="score-gb-setting" value="12" />全雙刻</label>
                            </div>
                            <span>雙暗槓</span>
                            <div class="output-option-group">
                                <label title="國標原文、問答規則、MIL規則、JMSA規則採用。"><input type="radio" name="score-gb-setting-1" value="0" checked />6 台</label>
                                <label title="世麻規則採用。"><input type="radio" name="score-gb-setting-1" value="23" />8 台</label>
                            </div>
                            <span>明暗槓</span>
                            <div class="output-option-group">
                                <label title="MIL規則、JMSA規則採用。"><input type="radio" name="score-gb-setting-2" value="0" checked />5 台</label>
                                <label title="世麻規則採用。"><input type="radio" name="score-gb-setting-2" value="24,1" />6 台</label>
                                <label title="1999年全國麻將運動比賽補充規定（參見疑難解析）。"><input type="radio" name="score-gb-setting-2" value="24,2" />明槓+暗槓</label>
                                <label title="問答規則採用。"><input type="radio" name="score-gb-setting-2" value="24,3" />雙明槓+暗槓</label>
                            </div>
                            <span>三槓四槓</span>
                            <div class="output-option-group">
                                <label title="MIL規則、JMSA規則採用。"><input type="radio" name="score-gb-setting-6" value="0" checked />加計暗刻不計暗槓</label>
                                <label title="世麻規則採用。"><input type="radio" name="score-gb-setting-6" value="30,1" />加計暗刻和暗槓</label>
                                <label title="問答規則採用。"><input type="radio" name="score-gb-setting-6" value="30,2" />請輸入文字</label>
                            </div>
                            <span>槓上開花</span>
                            <div class="output-option-group">
                                <label><input type="checkbox" name="score-gb-setting" value="31,1" />不計明槓</label>
                                <label title="疑難解析採用。"><input type="checkbox" name="score-gb-setting" value="31,2" />不計明槓且暗槓减 1 台</label>
                                <label title="問答規則、MIL規則、JMSA規則採用。"><input type="checkbox" name="score-gb-setting" value="32" checked />可複合妙手回春</label>
                            </div>
                            <span>不計么九刻</span>
                            <div class="output-option-group">
                                <label title="疑難解析採用。"><input type="checkbox" name="score-gb-setting" value="33" />圈風刻/門風刻/箭刻减 1 台</label>
                                <label><input type="checkbox" name="score-gb-setting" value="34" />三風刻加計么九刻</label>
                                <label><input type="checkbox" name="score-gb-setting" value="35" />小四喜加計么九刻</label>
                            </div>
                            <span>九蓮寶燈</span>
                            <div class="output-option-group">
                                <label title="MIL規則採用。"><input type="radio" name="score-gb-setting-5" value="0" checked />不計一个么九刻</label>
                                <label><input type="radio" name="score-gb-setting-5" value="27" />不計所有么九刻</label>
                            </div>
                            <span title="國標原文、問答規則、世麻規則、MIL規則允許缺一門複合大三元至一色四節高。">缺一門複合</span>
                            <div class="output-option-group">
                                <label><input type="checkbox" name="score-gb-setting" value="13" checked />大三元</label>
                                <label><input type="checkbox" name="score-gb-setting" value="14" checked />小三元</label>
                                <label><input type="checkbox" name="score-gb-setting" value="15" checked />三風刻</label>
                                <label><input type="checkbox" name="score-gb-setting" value="16" checked />一色四同順</label>
                                <label><input type="checkbox" name="score-gb-setting" value="44" checked />一色四步高</label>
                                <label><input type="checkbox" name="score-gb-setting" value="17" checked />一色四節高</label>
                                <label><input type="checkbox" name="score-gb-setting" value="18" />推不倒</label>
                            </div>
                            <span title="國標原文、問答規則、MIL規則允許混一色複合大四喜、小四喜；不允許混一色複合綠一色。世麻規則允許混一色複合下述所有台種。">混一色複合</span>
                            <div class="output-option-group">
                                <label><input type="checkbox" name="score-gb-setting" value="20" checked />大四喜</label>
                                <label><input type="checkbox" name="score-gb-setting" value="21" checked />小四喜</label>
                                <label><input type="checkbox" name="score-gb-setting" value="22" />綠一色</label>
                            </div>
                            <span>清么九複合</span>
                            <div class="output-option-group">
                                <label title="世麻規則採用。問答規則、MIL規則不採用。"><input type="checkbox" name="score-gb-setting" value="28" />雙同刻</label>
                                <label title="國標原文為「不計同刻」，若非筆誤則不採用。"><input type="checkbox" name="score-gb-setting" value="29" checked />三同刻</label>
                            </div>
                            <span>組合龍和牌</span>
                            <div class="output-option-group">
                                <label><input type="radio" name="score-gb-setting-3" value="25" />和牌張可解釋為組合龍部分时不計邊張/嵌張/單釣將</label>
                                <label title="MIL規則採用。"><input type="radio" name="score-gb-setting-3" value="0" checked />和牌張可解釋為順子或雀頭部分时可計邊張/嵌張/單釣將</label>
                            </div>
                            <span>多面聽和牌</span>
                            <div class="output-option-group">
                                <label title="問答規則、世麻規則、MIL規則採用。疑難解析建議採用。"><input type="radio" name="score-gb-setting-4" value="0" checked />不計邊張/嵌張/單釣將</label>
                                <label><input type="radio" name="score-gb-setting-4" value="26" />可計邊張/嵌張/單釣將</label>
                            </div>
                            <span>加槓全求人</span>
                            <div class="output-option-group">
                                <label><input type="radio" name="score-gb-setting-7" value="0" checked />開啟</label>
                                <label><input type="radio" name="score-gb-setting-7" value="36" />關閉</label>
                            </div>
                            <span>授受法</span>
                            <div class="output-option-group">
                                <label><input type="number" id="score-gb-setting-fan" value="8" min="0" />台起和</label>
                                <label><input type="number" id="score-gb-setting-blind" value="8" min="0" />台底台</label>
                                <label title="JMSA規則採用 88 台封頂。"><input type="checkbox" name="score-gb-setting" value="38" /><input type="number" id="score-gb-setting-maxfan" value="88" min="0" />台封頂</label>
                                <label><input type="checkbox" name="score-gb-setting" value="39" />自摸分三</label>
                            </div>
                            <span>快捷設定</span>
                            <div class="output-option-group">
                                <button onclick="processGBSetting(0)">MIL規則</button>
                                <button onclick="processGBSetting(1)">世麻規則</button>
                                <button onclick="processGBSetting(2)">JMSA規則</button>
                            </div>
                        </div>
                    </details>
                </div>
                <div class="output-context" id="output-score-gb"></div>
                <div class="output-context" id="brief-output-score-gb" style="display: none"></div>
                <div class="output-time" id="time-output-score-gb">Ready to start!</div>
            </div>
            <div class="reference-box mobile-display-only" id="title-box"></div>
            <div class="reference-box">
                相關規則：
                <ul style="margin-top: 0">   
                    <li><a href="./rules/Renmei.pdf">日本職業麻將聯盟官方規則和WRC規則（聯盟規則）</a></li>
                    <li><a href="./rules/Achieve/Saikouisen.html">最高位戰日本職業麻將協會競技規定（最高位戰規則）</a><a class="small-a" href="https://saikouisen.com/about/rules/" target="_blank" rel="noopener noreferrer">原始內容</a></li>
                    <li><a href="./rules/Achieve/ClubJPM.html">日本職業麻將協會競技規定（協會規則）</a><a class="small-a" href="https://npm2001.com/about/regulations/" target="_blank" rel="noopener noreferrer">原始內容</a></li>
                    <li><a href="./rules/Achieve/MLeague.html">M.League正式比賽規則（M.League）</a><a class="small-a" href="https://m-league.jp/about/" target="_blank" rel="noopener noreferrer">原始內容</a></li>
                    <li><a href="./rules/XJTU-Riichi.pdf">西安交通大學立直麻將比賽規則（XJTU規則）和西安交通大學七星杯立直麻將公開賽規則（XJTU七星杯）</a></li>
                    <li><a href="./rules/EMA-Riichi.pdf">歐洲麻將聯盟立直麻將規則（EMA規則）</a></li>
                    <li><a href="./rules/GB98.pdf">中國麻將競賽規則（國標原文）</a></li>
                    <li><a href="./rules/GB98-EC.pdf">中國麻將競賽規則疑難解析（疑難解析）</a></li>
                    <li><a href="./rules/GB98-FAQ.pdf">《中國麻將競賽規則（試行）》問答（問答規則）</a></li>
                    <li><a href="./rules/WMO-MCR.pdf">世界麻將組織麻將競賽規則（世麻規則）</a></li>
                    <li><a href="./rules/MIL-MCR.pdf">國際麻將聯盟國標麻將規則補充細則（MIL規則）</a></li>
                    <li><a href="./rules/Achieve/JMSA-MCR.html">日本麻將體育協會規則和台種一覽（JMSA規則）</a><a class="small-a" href="https://www.jmsa.jp/www/rule1.html" target="_blank" rel="noopener noreferrer">原始內容</a></li>
                </ul>
            </div>
        </div>
        <div class="section title-button-container">
            <div class="output-time">v4.7.1</div>
            <div class="output-time">聯絡作者：<a href="https://x.com/sheauhaw" style="color: inherit;">三倍滿自動姬</a></div>
        </div>
        <script src="mahjong.js"></script>
        <script src="mahjong-document.js"></script>
        <script>
            function tilesInfo(tcnt) {
                const meld = Math.floor(tcnt / 3);
                let output = `${tcnt} 張手牌\n`;
                switch (tcnt % 3) {
                    case 1:
                        output += `3n+1 型: 和牌需要 ${meld} 個面子和 ${1} 個雀頭`;
                        break;
                    case 2:
                        output += `3n+2 型: 和牌需要 ${meld} 個面子和 ${1} 個雀頭`;
                        break;
                    case 0:
                        output += `3n 型: 和牌需要 ${meld} 個面子和 ${0} 個雀頭`;
                        break;
                }
                return output;
            }
            function toggleInput() {
                const board = document.getElementById("boardInput");
                const button = document.getElementById("inputButton");
                const text = document.getElementById("textInput");
                const isVisible = board.style.display !== "none";
                board.style.display = isVisible ? "none" : "block";
                text.style.display = isVisible ? "block" : "none";
                button.textContent = isVisible ? "開啟輸入面板 ▼" : "關閉輸入面板 ▲";
                if (!isVisible) drawInputCards();
                if (!isVisible) adjustButtonsFontSize();
            }
            function toggleNote() {
                const note = document.getElementById("inputNote");
                const button = document.getElementById("inputNoteButton");
                const isVisible = note.style.display !== "none";
                note.style.display = isVisible ? "none" : "block";
                button.textContent = isVisible ? "顯示輸入說明 ▼" : "隱藏輸入說明 ▲";
            }
            window.onload = function () {
                loadStorage();
                addReferenceMark();
                loadInput();
            };
            const lang = "tw";
            const toggleOutputLang = ["展開 ▼" , "摺疊 ▲"];
        </script>
    </body>
</html>
